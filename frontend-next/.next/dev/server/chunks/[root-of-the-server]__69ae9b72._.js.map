{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///app/frontend-next/proxy.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport type { NextRequest } from 'next/server';\n\nconst API_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:8001';\n\n// Cache redirects in memory (refresh every 5 minutes)\nlet redirectsCache: { from: string; to: string; permanent: boolean }[] = [];\nlet lastFetch = 0;\nconst CACHE_DURATION = 5 * 60 * 1000; // 5 minutes\n\nasync function fetchRedirects() {\n  const now = Date.now();\n  \n  // Return cached if still fresh\n  if (redirectsCache.length > 0 && now - lastFetch < CACHE_DURATION) {\n    return redirectsCache;\n  }\n\n  try {\n    const response = await fetch(`${API_URL}/api/content/redirects`, {\n      next: { revalidate: 300 }, // 5 minutes\n    });\n\n    if (response.ok) {\n      const data = await response.json();\n      redirectsCache = data.redirects || [];\n      lastFetch = now;\n    }\n  } catch (error) {\n    console.error('Failed to fetch redirects:', error);\n  }\n\n  return redirectsCache;\n}\n\n// Named export for Next.js 16+ proxy\nexport async function proxy(request: NextRequest) {\n  const pathname = request.nextUrl.pathname;\n\n  // Skip proxy for certain paths\n  if (\n    pathname.startsWith('/_next') ||\n    pathname.startsWith('/api') ||\n    pathname.includes('.')\n  ) {\n    return NextResponse.next();\n  }\n\n  // Fetch and check redirects\n  const redirects = await fetchRedirects();\n  const redirect = redirects.find((r) => r.from === pathname);\n\n  if (redirect) {\n    const url = request.nextUrl.clone();\n    url.pathname = redirect.to;\n    \n    return NextResponse.redirect(url, redirect.permanent ? 308 : 307);\n  }\n\n  return NextResponse.next();\n}\n\nexport const config = {\n  matcher: [\n    /*\n     * Match all request paths except:\n     * - _next/static (static files)\n     * - _next/image (image optimization files)\n     * - favicon.ico (favicon file)\n     * - public files (public folder)\n     */\n    '/((?!_next/static|_next/image|favicon.ico|.*\\\\..*|api).*)',\n  ],\n};\n"],"names":[],"mappings":";;;;;;AAAA;;AAGA,MAAM,UAAU,2FAAmC;AAEnD,sDAAsD;AACtD,IAAI,iBAAqE,EAAE;AAC3E,IAAI,YAAY;AAChB,MAAM,iBAAiB,IAAI,KAAK,MAAM,YAAY;AAElD,eAAe;IACb,MAAM,MAAM,KAAK,GAAG;IAEpB,+BAA+B;IAC/B,IAAI,eAAe,MAAM,GAAG,KAAK,MAAM,YAAY,gBAAgB;QACjE,OAAO;IACT;IAEA,IAAI;QACF,MAAM,WAAW,MAAM,MAAM,GAAG,QAAQ,sBAAsB,CAAC,EAAE;YAC/D,MAAM;gBAAE,YAAY;YAAI;QAC1B;QAEA,IAAI,SAAS,EAAE,EAAE;YACf,MAAM,OAAO,MAAM,SAAS,IAAI;YAChC,iBAAiB,KAAK,SAAS,IAAI,EAAE;YACrC,YAAY;QACd;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,8BAA8B;IAC9C;IAEA,OAAO;AACT;AAGO,eAAe,MAAM,OAAoB;IAC9C,MAAM,WAAW,QAAQ,OAAO,CAAC,QAAQ;IAEzC,+BAA+B;IAC/B,IACE,SAAS,UAAU,CAAC,aACpB,SAAS,UAAU,CAAC,WACpB,SAAS,QAAQ,CAAC,MAClB;QACA,OAAO,kKAAY,CAAC,IAAI;IAC1B;IAEA,4BAA4B;IAC5B,MAAM,YAAY,MAAM;IACxB,MAAM,WAAW,UAAU,IAAI,CAAC,CAAC,IAAM,EAAE,IAAI,KAAK;IAElD,IAAI,UAAU;QACZ,MAAM,MAAM,QAAQ,OAAO,CAAC,KAAK;QACjC,IAAI,QAAQ,GAAG,SAAS,EAAE;QAE1B,OAAO,kKAAY,CAAC,QAAQ,CAAC,KAAK,SAAS,SAAS,GAAG,MAAM;IAC/D;IAEA,OAAO,kKAAY,CAAC,IAAI;AAC1B;AAEO,MAAM,SAAS;IACpB,SAAS;QACP;;;;;;KAMC,GACD;KACD;AACH"}}]
}